<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>前后端联调测试</title>
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>
<body>
    <h1>前后端代码联调 - Vue + Element UI</h1>
    <hr>
    <div id="app1">
        <el-select v-model="provId" filterable placeholder="请选择" @change="selectProv">
            <el-option
                    v-for="prov in provinces"
                    :key="prov.distid"
                    :label="prov.name"
                    :value="prov.distid">
            </el-option>
        </el-select>
        <el-select v-model="cityId" filterable placeholder="请选择" @change="selectCity">
            <el-option
                    v-for="city in cities"
                    :key="city.distid"
                    :label="city.name"
                    :value="city.distid">
            </el-option>
        </el-select>
        <el-select v-model="countyId" filterable placeholder="请选择" >
            <el-option
                    v-for="county in counties"
                    :key="county.distid"
                    :label="county.name"
                    :value="county.distid">
            </el-option>
        </el-select>

    </div>

    <script src="https://cdn.bootcss.com/vue/2.6.11/vue.min.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script>
        new Vue({
            el: '#app1',
            data: {
                provId: null,
                provinces: [],
                cityId: null,
                cities: [],
                countyId: null,
                counties: []
            },
            created() {
                fetch('/api/districts_2_2/')
                    .then(resp => resp.json())
                    .then(json => this.provinces = json.results)
            },
            methods: {
                selectProv() {
                    this.cities = []
                    this.cityId = null
                    this.counties = []
                    this.countyId = null
                    fetch('/api/districtd/' + this.provId)
                        .then(resp => resp.json())
                        .then(json => this.cities = json.cities)
                },
                selectCity() {
                    this.counties = []
                    this.countyId = null
                    fetch('/api/districtd/' + this.cityId)
                        .then(resp => resp.json())
                        .then(json => this.counties = json.cities)
                }
            }
        })
    </script>

</body>
</html>